services:
  server:
    image: mitre/heimdall2:2.6.13
    container_name: heimdall2-server
    restart: unless-stopped
    env_file: .env
    expose:
      - "3000"
    networks:
      - heimdall2-network

  nginx:
    image: nginx:alpine
    container_name: heimdall2-nginx
    restart: unless-stopped
    environment:
      NGINX_HOST: ${NGINX_HOST}
    volumes:
      - ./nginx/conf/:/etc/nginx/templates/
      - ./nginx/certs/:/etc/nginx/certs/
    ports:
      - "8443:443"
      - "8080:80"
    depends_on:
      - server
    networks:
      - heimdall2-network

# Removed cert_bundles volume - not needed for basic setup

networks:
  heimdall2-network:
    driver: bridge